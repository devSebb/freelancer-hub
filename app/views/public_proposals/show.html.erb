<div>
  <!-- Header -->
  <div class="bg-white/5 border border-white/10 rounded-2xl p-6 mb-6">
    <div class="flex items-start justify-between">
      <div>
        <h1 class="text-2xl font-bold text-white"><%= @proposal.title %></h1>
        <p class="mt-1 text-sm text-white/50">
          <%= t("public_proposals.from") %>: <%= @proposal.user.business_name.presence || @proposal.user.name %>
        </p>
      </div>
      <% if @proposal.expires_at.present? %>
        <div class="text-right">
          <span class="text-sm text-white/50"><%= t("public_proposals.expires") %></span>
          <p class="text-sm font-medium text-white"><%= @proposal.expires_at.strftime("%B %d, %Y") %></p>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Scope -->
  <% if @proposal.scope.present? %>
    <div class="bg-white/5 border border-white/10 rounded-2xl p-6 mb-6">
      <h2 class="text-lg font-semibold text-white"><%= t("proposals.scope") %></h2>
      <div class="mt-3 text-sm text-white/70 prose prose-invert prose-sm max-w-none">
        <%= simple_format(@proposal.scope) %>
      </div>
    </div>
  <% end %>

  <!-- Deliverables -->
  <% if @proposal.deliverables.present? %>
    <div class="bg-white/5 border border-white/10 rounded-2xl p-6 mb-6">
      <h2 class="text-lg font-semibold text-white"><%= t("proposals.deliverables") %></h2>
      <div class="mt-3 text-sm text-white/70 prose prose-invert prose-sm max-w-none">
        <%= simple_format(@proposal.deliverables) %>
      </div>
    </div>
  <% end %>

  <!-- Timeline & Pricing -->
  <div class="grid grid-cols-1 gap-6 sm:grid-cols-2 mb-6">
    <div class="bg-white/5 border border-white/10 rounded-2xl p-6">
      <h2 class="text-lg font-semibold text-white"><%= t("proposals.timeline") %></h2>
      <dl class="mt-3 space-y-3">
        <div class="flex justify-between">
          <dt class="text-sm text-white/50"><%= t("proposals.timeline_start") %></dt>
          <dd class="text-sm text-white"><%= @proposal.timeline_start&.strftime("%b %d, %Y") || "â€”" %></dd>
        </div>
        <div class="flex justify-between">
          <dt class="text-sm text-white/50"><%= t("proposals.timeline_end") %></dt>
          <dd class="text-sm text-white"><%= @proposal.timeline_end&.strftime("%b %d, %Y") || "â€”" %></dd>
        </div>
      </dl>
    </div>

    <div class="bg-white/5 border border-white/10 rounded-2xl p-6">
      <h2 class="text-lg font-semibold text-white"><%= t("proposals.pricing") %></h2>
      <dl class="mt-3 space-y-3">
        <div class="flex justify-between">
          <dt class="text-sm text-white/50"><%= t("proposals.pricing_type") %></dt>
          <dd class="text-sm text-white"><%= t("proposals.pricing_types.#{@proposal.pricing_type}") %></dd>
        </div>
        <% if @proposal.fixed? %>
          <div class="flex justify-between">
            <dt class="text-sm text-white/50"><%= t("proposals.amount") %></dt>
            <dd class="text-sm font-semibold text-emerald-400"><%= number_to_currency(@proposal.amount) %></dd>
          </div>
        <% else %>
          <div class="flex justify-between">
            <dt class="text-sm text-white/50"><%= t("proposals.hourly_rate") %></dt>
            <dd class="text-sm text-white"><%= number_to_currency(@proposal.hourly_rate) %>/hr</dd>
          </div>
          <div class="flex justify-between">
            <dt class="text-sm text-white/50"><%= t("proposals.estimated_hours") %></dt>
            <dd class="text-sm text-white"><%= @proposal.estimated_hours || "â€”" %></dd>
          </div>
          <div class="flex justify-between border-t border-white/10 pt-3 mt-3">
            <dt class="text-sm font-medium text-white"><%= t("public_proposals.estimated_total") %></dt>
            <dd class="text-sm font-semibold text-emerald-400"><%= number_to_currency(@proposal.total_amount) %></dd>
          </div>
        <% end %>
      </dl>
    </div>
  </div>

  <!-- Terms -->
  <% if @proposal.terms.present? %>
    <div class="bg-white/5 border border-white/10 rounded-2xl p-6 mb-6">
      <h2 class="text-lg font-semibold text-white"><%= t("proposals.terms") %></h2>
      <div class="mt-3 text-sm text-white/70 prose prose-invert prose-sm max-w-none">
        <%= simple_format(@proposal.terms) %>
      </div>
    </div>
  <% end %>

  <!-- Already Accepted -->
  <% if @proposal.accepted? %>
    <div class="bg-emerald-400/10 border border-emerald-400/20 rounded-2xl p-6 mb-6">
      <div class="flex items-center">
        <svg class="w-6 h-6 text-emerald-400 mr-3" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
        </svg>
        <div>
          <h3 class="text-lg font-semibold text-emerald-400"><%= t("public_proposals.already_accepted") %></h3>
          <p class="mt-1 text-sm text-emerald-400/70">
            <%= t("public_proposals.accepted_on", date: @proposal.signature_at&.strftime("%B %d, %Y")) %>
          </p>
        </div>
      </div>
    </div>

  <!-- Accept Form -->
  <% elsif @proposal.can_be_accepted? %>
    <div class="bg-white/5 border border-white/10 rounded-2xl p-6">
      <h2 class="text-lg font-semibold text-white mb-4"><%= t("public_proposals.accept_proposal") %></h2>
      <p class="text-sm text-white/60 mb-4"><%= t("public_proposals.accept_instructions") %></p>

      <%= form_with url: accept_public_proposal_path(@proposal.share_token), method: :post, class: "space-y-4" do |f| %>
        <div>
          <%= f.label :signature_name, t("public_proposals.signature_name"), class: "block text-sm font-medium text-white/70 mb-2" %>
          <%= f.text_field :signature_name, required: true, class: "w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-white/30 focus:outline-none focus:border-white/30 focus:ring-0 transition-colors", placeholder: t("public_proposals.signature_placeholder") %>
        </div>

        <div class="flex items-start">
          <%= f.check_box :agree_to_terms, required: true, class: "h-4 w-4 bg-white/5 border-white/20 rounded text-emerald-400 focus:ring-emerald-400 focus:ring-offset-0 mt-0.5" %>
          <%= f.label :agree_to_terms, t("public_proposals.agree_to_terms"), class: "ml-2 text-sm text-white/60" %>
        </div>

        <div>
          <%= f.submit t("public_proposals.accept_button"), class: "w-full px-6 py-3 bg-emerald-400 text-black text-sm font-semibold rounded-full hover:bg-emerald-300 transition-all duration-200 cursor-pointer" %>
        </div>

        <p class="text-xs text-white/40 text-center">
          <%= t("public_proposals.legal_notice") %>
        </p>
      <% end %>
    </div>
  <% end %>

  <!-- Contact -->
  <div class="mt-6 text-center text-sm text-white/50">
    <p><%= t("public_proposals.questions") %></p>
    <a href="mailto:<%= @proposal.user.email %>" class="text-emerald-400 hover:text-emerald-300 transition-colors"><%= @proposal.user.email %></a>
  </div>
</div>

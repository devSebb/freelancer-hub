<%= form_with model: template, class: "space-y-6" do |f| %>
  <% if template.errors.any? %>
    <div class="bg-red-400/10 border border-red-400/20 rounded-xl p-4">
      <div class="flex items-start gap-3">
        <svg class="w-5 h-5 text-red-400 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"/>
        </svg>
        <ul class="text-sm text-red-400 space-y-1">
          <% template.errors.full_messages.each do |message| %>
            <li><%= message %></li>
          <% end %>
        </ul>
      </div>
    </div>
  <% end %>

  <!-- Template Name -->
  <div class="bg-white/5 border border-white/10 rounded-2xl p-6">
    <div>
      <%= f.label :name, t("proposal_templates.name"), class: "block text-sm font-medium text-white/70 mb-2" %>
      <%= f.text_field :name, class: "w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-white/30 focus:outline-none focus:border-white/30 focus:ring-0 transition-colors", required: true, placeholder: t("proposal_templates.name_placeholder") %>
    </div>
  </div>

  <!-- Content Fields -->
  <div class="bg-white/5 border border-white/10 rounded-2xl p-6 space-y-5">
    <h2 class="text-lg font-semibold text-white mb-5"><%= t("proposal_templates.content") %></h2>

    <div>
      <%= f.label "content[scope]", t("proposals.scope"), class: "block text-sm font-medium text-white/70 mb-2" %>
      <%= f.text_area "content[scope]", value: template.content["scope"], rows: 4, class: "w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-white/30 focus:outline-none focus:border-white/30 focus:ring-0 transition-colors resize-none", placeholder: t("proposals.scope_placeholder") %>
    </div>

    <div>
      <%= f.label "content[deliverables]", t("proposals.deliverables"), class: "block text-sm font-medium text-white/70 mb-2" %>
      <%= f.text_area "content[deliverables]", value: template.content["deliverables"], rows: 4, class: "w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-white/30 focus:outline-none focus:border-white/30 focus:ring-0 transition-colors resize-none", placeholder: t("proposals.deliverables_placeholder") %>
    </div>

    <div>
      <%= f.label "content[terms]", t("proposals.terms"), class: "block text-sm font-medium text-white/70 mb-2" %>
      <%= f.text_area "content[terms]", value: template.content["terms"], rows: 4, class: "w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-white/30 focus:outline-none focus:border-white/30 focus:ring-0 transition-colors resize-none", placeholder: t("proposals.terms_placeholder") %>
    </div>
  </div>

  <!-- Pricing -->
  <div class="bg-white/5 border border-white/10 rounded-2xl p-6" data-controller="pricing">
    <h2 class="text-lg font-semibold text-white mb-5"><%= t("proposals.pricing") %></h2>

    <div class="space-y-5">
      <div>
        <%= f.label "content[pricing_type]", t("proposals.pricing_type"), class: "block text-sm font-medium text-white/70 mb-2" %>
        <%= f.select "content[pricing_type]",
            Proposal.pricing_types.keys.map { |pt| [t("proposals.pricing_types.#{pt}"), pt] },
            { selected: template.content["pricing_type"] || "fixed" },
            { class: "w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white focus:outline-none focus:border-white/30 focus:ring-0 transition-colors", data: { pricing_target: "type", action: "change->pricing#toggle" } } %>
      </div>

      <div data-pricing-target="fixed" class="<%= 'hidden' if template.content['pricing_type'] == 'hourly' %>">
        <%= f.label "content[amount]", t("proposals.amount"), class: "block text-sm font-medium text-white/70 mb-2" %>
        <div class="relative">
          <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
            <span class="text-white/40">$</span>
          </div>
          <%= f.number_field "content[amount]", value: template.content["amount"], step: 0.01, min: 0, class: "w-full pl-8 pr-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-white/30 focus:outline-none focus:border-white/30 focus:ring-0 transition-colors", placeholder: "0.00" %>
        </div>
      </div>

      <div data-pricing-target="hourly" class="<%= 'hidden' unless template.content['pricing_type'] == 'hourly' %> space-y-5">
        <div class="grid grid-cols-1 gap-5 sm:grid-cols-2">
          <div>
            <%= f.label "content[hourly_rate]", t("proposals.hourly_rate"), class: "block text-sm font-medium text-white/70 mb-2" %>
            <div class="relative">
              <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                <span class="text-white/40">$</span>
              </div>
              <%= f.number_field "content[hourly_rate]", value: template.content["hourly_rate"], step: 0.01, min: 0, class: "w-full pl-8 pr-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-white/30 focus:outline-none focus:border-white/30 focus:ring-0 transition-colors", placeholder: "0.00" %>
            </div>
          </div>

          <div>
            <%= f.label "content[estimated_hours]", t("proposals.estimated_hours"), class: "block text-sm font-medium text-white/70 mb-2" %>
            <%= f.number_field "content[estimated_hours]", value: template.content["estimated_hours"], step: 0.5, min: 0, class: "w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-white/30 focus:outline-none focus:border-white/30 focus:ring-0 transition-colors", placeholder: "0" %>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Submit -->
  <div class="flex justify-end gap-3 pt-4">
    <%= link_to t("common.cancel"), proposal_templates_path, class: "px-5 py-2.5 bg-white/10 text-white text-sm font-medium rounded-full hover:bg-white/20 transition-all duration-200" %>
    <%= f.submit class: "px-6 py-2.5 bg-white text-black text-sm font-semibold rounded-full hover:bg-white/90 transition-all duration-200 cursor-pointer" %>
  </div>
<% end %>
